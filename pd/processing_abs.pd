#N canvas 339 118 1920 984 12;
#X text 129 931 dimm wert fuer lampe (und gui);
#X floatatom 17 623 10 0 0 0 - - -;
#X obj 17 155 spigot 1;
#X msg 107 125 1;
#X msg 70 125 0;
#X obj 107 98 r \$0-openSpigot;
#X text 131 946 brightness in relation to sensor distance;
#X text 88 837 cut all values above 255;
#X msg 77 861 255;
#X obj 17 834 moses 255;
#X obj 17 722 moses;
#X text 78 726 when gew√ºnschter sensor wert erreicht von line \; oeffne
spigot wieder;
#X obj 49 762 t b f;
#X obj 49 788 s \$0-openSpigot;
#X msg 404 509 \$1 300;
#X obj 17 181 t f b;
#X obj 17 599 line 0;
#X text 95 600 turn on/off lamp slowly when sensor is de-/activated
;
#X obj 70 -30 r sensor_enable;
#X text 89 6 from control panel;
#X obj 89 489 r lamp_decay;
#X obj 17 526 pack f f;
#X text 104 264 settings for transition to 255 and zero (transition
to zero is adjustable from control panel);
#X obj 483 3 s \$0-init;
#X obj 70 436 r \$0-init;
#X msg 70 460 1000;
#X text 180 490 from control panel;
#X text 462 504 on transition;
#X text 85 527 off transition;
#X obj 436 346 s \$0-currentSensorVal;
#X obj 49 692 r \$0-currentSensorVal;
#X obj 49 329 s \$0-currentSensorVal;
#X text 943 936 flag to indicate activity on a lamp/sensor;
#X obj 404 319 t f f;
#X msg 879 895 1;
#X msg 833 893 0;
#X obj 17 299 t f f;
#X obj 17 234 route 1;
#X obj 833 866 route 1;
#X text 161 -238 1..255 from arduino;
#X text 491 -236 255 oder 1 from mouse;
#X obj 483 -21 r \$3-processing_workaround_loadbang;
#X obj 17 -244 r \$1-\$2-sensor_data;
#X obj 17 941 s \$1-\$2-dimval;
#X obj 992 820 r \$3-mouse_trigger;
#X obj 346 -240 r \$3-mouse_trigger;
#X obj 17 3 spigot 1;
#X obj 833 939 s \$1-\$2-active;
#X obj 486 937 s serial_output;
#X msg 503 766 20;
#X obj 619 528 int;
#X obj 920 453 r \$0-brett_indicator_dec;
#X msg 920 553 set \$1;
#X obj 619 561 t f b b;
#X obj 665 598 s \$0-get_brett_indic_dec;
#X obj 936 592 r \$0-lamp_indicator_dec;
#X obj 642 625 s \$0-get_lamp_indic_dec;
#X obj 920 521 makefilename B%dL%%dV;
#X obj 920 652 makefilename;
#X obj 619 694 pack f s;
#X obj 1209 434 r \$3-lamp_indicator_decimal;
#X obj 1191 461 f 0;
#X obj 1425 438 r \$3-brett_indicator_decimal;
#X obj 1407 464 f 0;
#X obj 1191 515 s \$0-lamp_indicator_dec;
#X obj 1407 516 s \$0-brett_indicator_dec;
#X obj 1191 401 r \$0-get_lamp_indic_dec;
#X obj 1407 399 r \$0-get_brett_indic_dec;
#X text 1188 341 workaround to store the abstractions' creation arguments
for later use ([f $xy] does not work in dynamically created absstractions)
;
#X text 790 126 22/3/22 \; this subpatch builds up a string from the
decimal brett-id and lamp-id and also puts in the current dimVal. \;
Goal: Send this stuff over to the arduino in order to route the correct
dimValue to the correct lamp. \; Form of the string: B1L24V255@ \;
B: Brett-id \; L: Lamp-id \; V: DimValue \; @: terminating character
;
#X obj 920 477 + 1;
#X text 952 478 Physical brett starts at 1;
#X obj 936 616 + 1;
#X text 974 614 Physical lamp starts at 1;
#X msg 619 718 symbol \$2\$1@;
#X obj 644 759 print;
#X obj 1156 422 bng 15 250 50 0 empty empty empty 17 7 0 10 -262144
-1 -1;
#X obj 1237 487 print;
#X obj 612 486 r \$1-\$2-dimval;
#X text 606 939 z.B. B1L4V200@;
#X obj 1355 667 r \$1-\$2-dimval;
#X obj 1355 710 moses 90;
#X obj 1408 748 t f b;
#X obj 1440 781 s \$0-get_lamp_indic_dec;
#X obj 1461 814 r \$0-lamp_indicator_dec;
#X obj 1461 839 + 1;
#X text 1496 835 Physical brett starts at 1;
#X obj 1408 865 pack f f;
#X text 1432 706 dimval-threshold for triggering audio;
#X obj 1373 935 s AUDIO_INFO;
#X text 1489 933 dimval : brett_indicator_dec;
#X obj 1260 701 print;
#X obj 178 -141 print data;
#X msg 17 258 1;
#X obj 54 -204 print;
#X obj 38 -65 print smooh out \$2;
#X obj 17 -146 data_smoothing4;
#X obj 833 821 r \$1-\$2-dimval;
#X obj 136 -182 outlet;
#X connect 1 0 10 0;
#X connect 2 0 15 0;
#X connect 3 0 2 1;
#X connect 4 0 2 1;
#X connect 5 0 3 0;
#X connect 8 0 43 0;
#X connect 9 0 43 0;
#X connect 9 1 8 0;
#X connect 10 0 9 0;
#X connect 10 1 12 0;
#X connect 12 0 13 0;
#X connect 12 1 9 0;
#X connect 14 0 16 0;
#X connect 15 0 37 0;
#X connect 15 1 4 0;
#X connect 16 0 1 0;
#X connect 18 0 46 1;
#X connect 20 0 21 1;
#X connect 21 0 16 0;
#X connect 24 0 25 0;
#X connect 25 0 21 1;
#X connect 30 0 10 1;
#X connect 33 0 14 0;
#X connect 33 1 29 0;
#X connect 34 0 47 0;
#X connect 35 0 47 0;
#X connect 36 0 21 0;
#X connect 36 1 31 0;
#X connect 37 0 93 0;
#X connect 37 1 33 0;
#X connect 38 0 35 0;
#X connect 38 1 34 0;
#X connect 41 0 23 0;
#X connect 42 0 96 0;
#X connect 42 0 98 0;
#X connect 44 0 38 0;
#X connect 45 0 2 0;
#X connect 46 0 2 0;
#X connect 50 0 53 0;
#X connect 51 0 70 0;
#X connect 52 0 58 0;
#X connect 53 0 59 0;
#X connect 53 1 56 0;
#X connect 53 2 54 0;
#X connect 55 0 72 0;
#X connect 57 0 52 0;
#X connect 58 0 59 1;
#X connect 59 0 74 0;
#X connect 60 0 61 1;
#X connect 61 0 64 0;
#X connect 62 0 63 1;
#X connect 63 0 65 0;
#X connect 66 0 61 0;
#X connect 67 0 63 0;
#X connect 70 0 57 0;
#X connect 72 0 58 0;
#X connect 74 0 48 0;
#X connect 76 0 61 0;
#X connect 78 0 50 0;
#X connect 80 0 81 0;
#X connect 81 1 82 0;
#X connect 82 0 87 0;
#X connect 82 1 83 0;
#X connect 84 0 85 0;
#X connect 85 0 87 1;
#X connect 87 0 89 0;
#X connect 93 0 36 0;
#X connect 96 0 46 0;
#X connect 97 0 38 0;
